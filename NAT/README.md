# Домашнее задание к занятию "NAT"

## Задание 1.

Вы подняли на своём домашнем компьютере с IP-адресом 192.168.0.2 web-сервер.

Получится ли у пользователей интернета открыть этот сайт?
Нужно ли будет вам для этого что-то сделать дополнительно?
Существует ли такой набор настроек провайдера, который не позволит подключение?
Поразмышляйте над примером.

Приведите ответ в свободной форме.

### Ответ: 

Данныцй сайт будет доступен по IP-адресу 192.168.0.2 только для пользователей внутренней сети. 
для того, чтобы данный сайт был доступен из "вне", то необходимо обратиться к провайдеру для предоставления "белого" IP и настроить на маршрутизаторе перенаправление 80го порта с этого белого на внутренний.

Мне о настройках провайдера, запрещающих подключение, не известно. Если имелся ввиду динамический IP адрес, так он не запрещает подключение, просто меняет IP на сессию.

## Задание 2.

Узел src инициировал соединение с узлом dst.
На маршрутизаторе узла src была создана трансляция:

![image](https://user-images.githubusercontent.com/121933872/220830938-fcbb35b6-d33d-4af1-8fd9-39c587473834.png)

Применив знания по установке TCP сессий, ответьте на вопросы:

Сможет ли злоумышленник доставить пакет до 10.0.0.2, отправив пакет на адрес/порт 93.15.10.2:2222 с адреса 74.5.12.4?
А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - 1.1.1.1:80
Приведите ответ в свободной форме.

### Ответ: 

Он не сможет доставить пакет до 10.0.0.2 т.к. в таблице трансляции с 93.15.10.2:2222 на 1.1.1.1:80 

Даже, если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - 1.1.1.1:80, доставить пакет невозможно т.к. он не участвовал в трёхстороннем рукопожатии и у него нет параметров идентификаторов для данного соединения(ISSa и ISSb)

## Задание 3.

Узел src инициировал соединение с узлом dst.
На маршрутизаторе узла src была создана трансляция:

src local IP:port	src global IP:port	dst IP	protocol
10.0.0.2:1111	93.15.10.2:2222	8.8.8.8:53	udp
Применив знания по работе UDP, ответьте на вопросы:

Сможет ли злоумышленник доставить пакет до 10.0.0.2, отправив пакет на адрес/порт 93.15.10.2:2222 с адреса 74.5.12.4?
А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - 8.8.8.8:53
Приведите ответ в свободной форме.

### Ответ: 

Как и в задании №2 Он не сможет доставить пакет до 10.0.0.2 т.к. в таблице трансляции с 93.15.10.2:2222 на 8.8.8.8:53

В отличии от предыдущего задания при UDP не используется тройцное рукопожатие и в таком случае у злоумышлиника получится отправить пакет, если подменит source IP-адрес и сгенерирует пакет с source IP:port - 8.8.8.8:53


## Задание 4.

Найдите самую часто встречающуюся проблему при работе клиентов за NAT с протоколом FTP, связанную с особенностью работы FTP (на лекции по портам эта особенность упоминалась).

1) В чём выражается проблема?
2) Почему она возникает?
3) Что можно сделать, чтобы избежать этой проблемы?

Приведите ответ в свободной форме.


### Ответ: 

1) Проблема при работе протокола FTP с NAT связана с отсутствием соединения между клиентом и сервером

2) Возникает данная проблема из-за особенностей работы протокола FTP. 

Он использует несколько соединений: одно для управляющих команд (20 и 21 порт), остальные для данных (пул динамических портов). Причем соединений для передачи данных может открываться несколько, в каждом из которых файлы могут передаваться в обоих направлениях. 

Также, для передачи данных различают активный и пассивный режимы работы FTP. В активном режиме сервер сам устанавливает соединение передачи данных к клиенту, в пассивном наоборот


3) В большинстве случаев для нормальной работы FTP-сервера за NAT достаточно будет настроить Destination NAT, т.е. пробросить 21 порт для управляющей сессии, 20 - для активного режима (если используется), а также указать и пробросить пул динамических портов для передачи данных. Это необходимо сделать потому, что номер порта передается сервером в управляющей команде и ничего не знает о настроенном PAT. Соответственно, если номер порта, переданный сервером, не совпадет с номером порта на внешнем интерфейсе, то клиент не сможет установить соединение.





# Дополнительные задания (со звездочкой)*
# Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

## Задание 5.

Вспомните схему из 3-го урока.

![image](https://user-images.githubusercontent.com/121933872/220829496-206f5087-fe49-474f-b4eb-b306b2c6a136.png)


Немного перефразируем прошлый вопрос.

Поразмышляете, можно ли каким-то образом отправлять пакеты с компьютера 192.168.1.2 на компьютер 192.168.1.3 если они подключены согласно приведённой ниже схеме?
Если да, то что и как бы вы предложили настроить? Как и к чему нужно подключаться?
Приведите ответ в свободной форме.

### Ответ: 



